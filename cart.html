<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Angular -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular-route.js"></script>
    <script src="/angular.min.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@400;700&display=swap" rel="stylesheet" />
    <!--! font awesome-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link rel="shortcut icon" href="./images/favicon.ico" type="image/x-icon" />

    <!-- Carousel -->
    <link rel="stylesheet" href="node_modules/@glidejs/glide/dist/css/glide.core.min.css" />
    <link rel="stylesheet" href="node_modules/@glidejs/glide/dist/css/glide.theme.min.css" />

    <!-- Animate On Scroll -->
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />


    <!-- Custom StyleSheet -->
    <link rel="stylesheet" href="styles.css" />

    <title>Phone Shop</title>

</head>

<body ng-app="myApp">
    <!--!---------------@ Header @----------------->
    <div id="header-container"></div>
    <!--!--------------@ Header @----------------->
    <header id="header" class="header">
        <!-- This is the header section -->
    
        <div class="page__title-area">
            <!-- Container for the page title area -->
            <div class="container">
                <!-- Main container -->
    
                <div class="page__title-container">
                    <!-- Container for the page titles -->
                    <ul class="page__titles">
                        <!-- List of page titles -->
    
                        <li>
                            <!-- Home link -->
                            <a href="/">
                                <svg>
                                    <!-- Home icon -->
                                    <use xlink:href="./images/sprite.svg#icon-home"></use>
                                </svg>
                            </a>
                        </li>
    
                        <li class="page__title">Cart</li>
                        <!-- Page title: Cart -->
                    </ul>
                </div>
            </div>
        </div>
    </header>
    
    <main id="main">
        <!-- Main section -->
    
        <section class="section cart__area">
            <!-- Cart area section -->
    
            <div class="container">
                <!-- Main container -->
    
                <div class="responsive__cart-area">
                    <!-- Responsive cart area -->
    
                    <form class="cart__form">
                        <!-- Cart form -->
    
                        <div class="cart__table table-responsive">
                            <!-- Cart table -->
                            <table width="100%" class="table">
                                <!-- Table for cart items -->
                                <thead>
                                    <tr>
                                        <th>PRODUCT</th>
                                        <th>NAME</th>
                                        <th>UNIT PRICE</th>
                                        <th>QUANTITY</th>
                                        <th>TOTAL</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="product__thumbnail">
                                            <!-- Product thumbnail -->
                                            <a href="#">
                                                <img id="product-image" src="" alt="">
                                            </a>
                                        </td>
                                        <td class="product__name">
                                            <!-- Product name -->
                                            <a href="#" id="product-title"></a>
                                            <br><br>
                                            <small id="product-color-size"></small>
                                        </td>
                                        <td class="product__price">
                                            <!-- Product price -->
                                            <div class="price">
                                                <span class="new__price" id="product-price"></span>
                                            </div>
                                        </td>
                                        <td class="product__quantity">
                                            <!-- Product quantity -->
                                            <div class="input-counter">
                                                <div>
                                                    <span class="minus-btn" id="minus-btn">
                                                        <svg>
                                                            <!-- Minus icon -->
                                                            <use xlink:href="./images/sprite.svg#icon-minus"></use>
                                                        </svg>
                                                    </span>
                                                    <input type="text" min="1" value="1" max="10" class="counter-btn"
                                                        id="product-quantity">
                                                    <span class="plus-btn" id="plus-btn">
                                                        <svg>
                                                            <!-- Plus icon -->
                                                            <use xlink:href="./images/sprite.svg#icon-plus"></use>
                                                        </svg>
                                                    </span>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="product__subtotal">
                                            <!-- Product subtotal -->
                                            <div class="price">
                                                <span class="new__price" id="product-subtotal"></span>
                                            </div>
                                            <a href="#" class="remove__cart-item" id="remove-cart-item-link">
                                                <svg>
                                                    <!-- Trash icon -->
                                                    <use xlink:href="./images/sprite.svg#icon-trash"></use>
                                                </svg>
                                            </a>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
    
                        <div class="cart-btns">
                            <!-- Cart buttons -->
                            <div class="continue__shopping">
                                <!-- Continue shopping button -->
                                <a href="product.html">Continue Shopping</a>
                            </div>
                            <div class="check__shipping">
                                <!-- Shipping checkbox -->
                                <input type="checkbox" id="shipping-checkbox">
                                <span>Shipping(+7$)</span>
                            </div>
                        </div>
    
                        <div class="cart__totals">
                            <!-- Cart totals -->
                            <h3>Cart Totals</h3>
                            <ul>
                                <li>
                                    Subtotal
                                    <span class="new__price">$<span id="sub-total"></span></span>
                                </li>
                                <li>
                                    Shipping
                                    <span id="shipping-cost">$0.00</span>
                                </li>
                                <li>
                                    Total
                                    <span class="new__price" id="total"></span>
                                </li>
                            </ul>
                            <a href="" onclick="openPopup()">PROCEED TO CHECKOUT</a>
                        </div>
                    </form>
                </div>
            </div>
        </section>
    
        <!-- Facility Section -->
        <section class="facility__section section" id="facility">
            <!-- Facility section -->
    
            <div class="container">
                <!-- Main container for facility section -->
    
                <div class="facility__contianer">
                    <!-- Container for facility items -->
    
                    <div class="facility__box">
                        <!-- Facility box 1 -->
                        <div class="facility-img__container">
                            <svg>
                                <!-- Airplane icon -->
                                <use xlink:href="./images/sprite.svg#icon-airplane"></use>
                            </svg>
                        </div>
                        <p>FREE SHIPPING WORLD WIDE</p>
                    </div>
    
                    <div class="facility__box">
                        <!-- Facility box 2 -->
                        <div class="facility-img__container">
                            <svg>
                                <!-- Credit card icon -->
                                <use xlink:href="./images/sprite.svg#icon-credit-card-alt"></use>
                            </svg>
                        </div>
                        <p>100% MONEY BACK GUARANTEE</p>
                    </div>
    
                    <div class="facility__box">
                        <!-- Facility box 3 -->
                        <div class="facility-img__container">
                            <svg>
                                <!-- Credit card icon -->
                                <use xlink:href="./images/sprite.svg#icon-credit-card"></use>
                            </svg>
                        </div>
                        <p>MANY PAYMENT GATWAYS</p>
                    </div>
    
                    <div class="facility__box">
                        <!-- Facility box 4 -->
                        <div class="facility-img__container">
                            <svg>
                                <!-- Headphones icon -->
                                <use xlink:href="./images/sprite.svg#icon-headphones"></use>
                            </svg>
                        </div>
                        <p>24/7 ONLINE SUPPORT</p>
                    </div>
                </div>
            </div>
        </section>
    </main>
    
    <!-- ! Popup event -->
    <div class="toast">
        <div class="toast-content">
            <i class="fas fa-solid fa-check check"></i>
        </div>
    </div>

    <!--!============== Footer ================-->
    <div id="footer-container"></div>
    <!--!============== Footer ================-->

    <!-- End Footer -->

    <!-- Go To -->

    <a href="#header" class="goto-top scroll-link">
        <svg>
            <use xlink:href="./images/sprite.svg#icon-arrow-up"></use>
        </svg>
    </a>
    <!-- script -->
    <script>
       // Get product ID from URL
function getProductIdFromURL() {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get('id');
}

// Fetch product information from products.json
fetch('products.json')
    .then(response => response.json())
    .then(data => {
        const products = data.products;
        var matchedProduct = null;
        const idFromHref = getProductIdFromURL(); // Get ID value from URL

        for (var i = 0; i < products.length; i++) {
            if (products[i].id == idFromHref) { // Compare by ID value
                matchedProduct = products[i];
                break;
            }
        }

        // Check if a product is found
        if (matchedProduct) {
            // Populate data from JSON into HTML elements
            document.getElementById("product-image").src = matchedProduct.image;
            document.getElementById("product-title").textContent = matchedProduct.title;
            document.getElementById("product-color-size").textContent = matchedProduct.color[0] + ' / ' + matchedProduct.display_size[0];
            document.getElementById("product-price").textContent = "$" + matchedProduct.price.toFixed(2);
            document.getElementById("product-quantity").value = 1;
            updateSubtotal(matchedProduct.price, 1);

            // Update product ID in href of the remove__cart-item link
            document.getElementById("remove-cart-item-link").setAttribute("data-id", matchedProduct.id);
            document.getElementById("remove-cart-item-link").addEventListener("click", removeCartItem);

            // Increase and decrease quantity when user clicks on "+" and "-"
            const quantityInput = document.getElementById("product-quantity");
            const plusBtn = document.getElementById("plus-btn");
            const minusBtn = document.getElementById("minus-btn");

            plusBtn.addEventListener('click', function () {
                let quantity = parseInt(quantityInput.value);
                quantity += 1;
                quantityInput.value = quantity;
                updateSubtotal(matchedProduct.price, quantity);
            });

            minusBtn.addEventListener('click', function () {
                let quantity = parseInt(quantityInput.value);
                if (quantity > 1) {
                    quantity -= 1;
                    quantityInput.value = quantity;
                    updateSubtotal(matchedProduct.price, quantity);
                }
            });

            // Update subtotal and total prices
            function updateSubtotal(price, quantity) {
                const subtotal = price * quantity;
                document.getElementById("product-subtotal").textContent = subtotal.toFixed(2);
                updateTotal(subtotal);
            }

            function updateTotal(subtotal) {
                const shippingCheckbox = document.getElementById("shipping-checkbox");
                const totalElement = document.getElementById("total");

                if (shippingCheckbox.checked) {
                    const shippingCost = 7;
                    const total = subtotal + shippingCost;
                    document.getElementById("shipping-cost").textContent = "$" + shippingCost.toFixed(2);
                    totalElement.textContent = "$" + total.toFixed(2);
                } else {
                    document.getElementById("shipping-cost").textContent = "$0.00";
                    totalElement.textContent = "$" + subtotal.toFixed(2);
                }
                const subtotalElement = document.getElementById("sub-total");
                subtotalElement.textContent = subtotal.toFixed(2);
            }

            // Handle shipping checkbox event
            const shippingCheckbox = document.getElementById("shipping-checkbox");
            shippingCheckbox.addEventListener('click', function () {
                const subtotal = parseFloat(document.getElementById("product-subtotal").textContent);
                updateTotal(subtotal);
            });

            // Remove product from cart
            function removeCartItem(event) {
                event.preventDefault();
                const productId = this.getAttribute("data-id");
                removeProductFromCart(productId);
                updateCart();
                alert("Product removed successfully!");
                window.location.href = "cart.html";
            }

            function removeProductFromCart(productId) {
                // Get cart items from storage or temporary data in the page
                const cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];

                // Find the product in the cart based on productId
                const index = cartItems.findIndex(item => item.productId === productId);

                // If the product is found, remove it from the cart
                if (index !== -1) {
                    cartItems.splice(index, 1);
                }

                // Update the cart in storage or update the temporary data in the page
                localStorage.setItem('cartItems', JSON.stringify(cartItems));
            }

            // Update the cart
            function updateCart() {
                let subtotal = 0;
                const productSubtotals = document.querySelectorAll(".product__subtotal .new__price");

                productSubtotals.forEach(function (subtotalElement) {
                    subtotal += parseFloat(subtotalElement.textContent.substring(1));
                });

                const subtotalElement = document.getElementById("subtotal");
                subtotalElement.textContent = "$" + subtotal.toFixed(2);
            }

            updateCart();
        } else {
            console.log("Product with the given ID was not found.");
        }
    })
    .catch(error => {
        console.log("An error occurred: ", error);
    });

// Popup for the "Proceed to Checkout" button
let popup = document.getElementById("popup");

function openPopup() {
    popup.classList.add("open-popup");
}

            //CSS add 
        

        // function closePopup() {
        //     popup.classList.remove("open-popup");
        // }
    </script>
    <!-- Glide Carousel Script -->
    <script src="node_modules/@glidejs/glide/dist/glide.min.js"></script>

    <!-- Animate On Scroll -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <!-- Custom JavaScript -->
    <script src="js/detail.js"></script>
    <script src="js/index.js"></script>
    <script src="js/slider.js"></script>
    <script src="js/script.js"></script>
    <script src="js/product.js"></script>
</body>

</html>